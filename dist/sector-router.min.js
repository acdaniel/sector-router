/** sector-router v0.1.6 | (c) 2014 Adam Daniel <adam@acdaniel.com> | MIT license */
!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self);var i=t;i=i.sector||(i.sector={}),i=i.ext||(i.ext={}),i.router=e()}}(function(){return function e(t,i,o){function n(a,s){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=i[a]={exports:{}};t[a][0].call(c.exports,function(e){var i=t[a][1][e];return n(i?i:e)},c,c.exports,e,t,i,o)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(e,t){var i;try{i=e("sector")}catch(o){i=window.sector}var n=e("../mixins/route-content");t.exports=i.Component.define({type:"route-content"},i.mixins.View,n)},{"../mixins/route-content":5}],2:[function(e,t){var i;try{i=e("sector")}catch(o){i=window.sector}var n=e("../mixins/route-nav");t.exports=i.Component.define({type:"route-nav"},i.mixins.View,n)},{"../mixins/route-nav":6}],3:[function(e,t){var i;try{i=e("sector")}catch(o){i=window.sector}var n=/\((.*?)\)/g,r=/(\(\?)?:\w+/g,a=/\*\w+/g,s=/[\-{}\[\]+?.,\\\^$|#\s]/g;t.exports=i.Component.define({type:"router",defaults:{mode:"hash",root:"/",routeTopic:"ui.routeChanged",backRequestTopic:"ui.navigateBackRequested",forwardRequestTopic:"ui.navigateForwardRequested",navigateRequestTopic:"ui.navigateRequested",uiReadyTopic:"ui.ready",defaultRoute:"home"},initialize:function(e){if(history.pushState||(this.mode="hash"),"/"!==this.root&&(this.root="/"+this.clearSlashes(e.root)+"/"),this.routes={},e.routes)for(var t in e.routes)this.addRoute(t,e.routes[t]);this.subscribe(this.navigateRequestTopic,this.handleNavigateRequest),this.subscribe(this.backRequestTopic,this.handleBackRequest),this.subscribe(this.forwardRequestTopic,this.handleForwardRequest),this.listenTo(window,"hashchange",this.handleHashChange),this.subscribe(this.uiReadyTopic,function(){var e=this.parseFragment(this.getFragment());this.publish(this.routeTopic,e)})},addRoute:function(e,t){t=t.replace(s,"\\$&").replace(n,"(?:$1)?").replace(r,function(e,t){return t?e:"([^/?]+)"}).replace(a,"([^?]*?)");var i=new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$");this.trace("adding named route: "+e,i),this.routes[e]=i},getFragment:function(){var e,t="";return"history"===this.mode?(t=this.clearSlashes(decodeURI(location.pathname+location.search)),t=t.replace(/\?(.*)$/,""),t="/"!==this.root?t.replace(this.root,""):t):(e=window.location.href.match(/#(.*)$/),t=e?e[1]:""),t},parseFragment:function(e){e=e||"/",this.trace("parsing fragment "+e);for(var t in this.routes){var o=this.routes[t];this.trace("eval route "+t,o);var n=o.exec(e);if(n)return n=n.slice(1),{name:t,path:e,params:i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}}return{name:this.defaultRoute,path:e,params:[]}},clearSlashes:function(e){return e.toString().replace(/\/$/,"").replace(/^\//,"")},handleHashChange:function(){var e,t;e=this.getFragment(),t=this.parseFragment(e),this.publish(this.routeTopic,t)},handleNavigateRequest:function(e){var t=e.data?e.data:"";"history"===this.mode?history.pushState(null,null,this.root+this.clearSlashes(t)):(window.location.href.match(/#(.*)$/),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+t);var i=this.parseFragment(t);this.publish(this.routeTopic,i)},handleBackRequest:function(){var e,t;window.history.back(),e=this.getFragment(),t=this.parseFragment(e),this.publish(this.routeTopic,t)},handleForwardRequest:function(){var e,t;window.history.forward(),e=this.getFragment(),t=this.parseFragment(e),this.publish(this.routeTopic,t)}})},{}],4:[function(e,t,i){i.mixins={RouteContent:e("./mixins/route-content"),RouteNav:e("./mixins/route-nav")},i.components={Router:e("./components/router"),RouteContent:e("./components/route-content"),RouterNav:e("./components/route-nav")}},{"./components/route-content":1,"./components/route-nav":2,"./components/router":3,"./mixins/route-content":5,"./mixins/route-nav":6}],5:[function(e,t){var i;try{i=e("sector")}catch(o){i=window.sector}t.exports=function(){this.defaults=i.defaults({},this.defaults,{route:null,activeClassName:"active",routeChangedTopic:"ui.routeChanged"}),this.after("initialize",function(){this.subscribe(this.routeChangedTopic,function(e){this.route===e.data.name?i.addClassName(this.el,this.activeClassName):i.removeClassName(this.el,this.activeClassName)})})}},{}],6:[function(e,t){var i;try{i=e("sector")}catch(o){i=window.sector}t.exports=function(){this.defaults=i.defaults({},this.defaults,{activeClassName:"active",linkSelector:"a[href]",routeChangedTopic:"ui.routeChanged"}),this.after("initialize",function(){this.subscribe(this.routeChangedTopic,function(e){for(var t,o=[].slice.call(this.selectAll(this.linkSelector)),n=0,r=o.length;r>n;n++)t=o[n],t.getAttribute("href").toString()==="#"+e.data.path?i.addClassName(t,this.activeClassName):i.removeClassName(t,this.activeClassName)})})}},{}]},{},[4])(4)});